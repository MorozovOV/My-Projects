#  Дипломная работа. Предсказание стоимости домов.

## Оглавление  
[1. Описание проекта](README.md#Описание-проекта)  
[2. Какой кейс решаем?](README.md#Какой-кейс-решаем)  
[3. Краткая информация о данных](README.md#Краткая-информация-о-данных)  
[4. Этапы работы над проектом](README.md#Этапы-работы-над-проектом)  
[5. Результат](README.md#Результаты)    
[6. Выводы](README.md#Выводы) 

### Описание проекта    
Нам предоставили набор данных, содержащий информацию о стоимости домов в США.
:arrow_up:[к оглавлению](README.md#Оглавление)


### Какой кейс решаем?    
**Бизнес-задача**: разработать сервис для предсказания стоимости домов на основе истории предложений.

**Техническая задача для специалиста в Data Science**: построить модель регрессии, которая бы с наилучшей точностью предсказывала стоимость домов. Сделать деплой модели.

**Метрика качества**     
Оценка качества модели производилась при помощи метрики mean absolute percentage error (MAPE).

**Использованные библиотеки Python**
pandas
numpy
re
BeautifulSoup
matplotlib
seaborn
missingno
sklearn
catboost
xgboost
optuna
pickle

### Краткая информация о данных
В использованном нами [набре данных](https://drive.google.com/file/d/11-ZNNIdcQ7TbT8Y0nsQ3Q0eiYQP__NIW/view) содержится следующая информация:
* 'status' - статус дома ("активный", "на продажу" и т.п.),
* 'private pool' - наличие частного бассейна,
* 'propertyType' - тип недвижимости,
* 'street' - улица,
* 'baths' - количество вонных комнат,
* 'homeFacts' - факты о доме,
* 'fireplace' - наличие камина,
* 'city' - город, в котором находится дом,
* 'schools' - школы,
* 'sqft' - площадь в кв. футах,
* 'zipcode' - почтовый индекс,
* 'beds' - количество кроватей,
* 'state' - штат, в котором находится дом,
* 'stories' - количество этажей в доме,
* 'mls-id' - mls-идентификатор,
* 'PrivatePool' - наличие частного бассейна,
* 'MlsId' - Mls-идентификатор
* 'target' - стоимость дома **(целевой признак)**
:arrow_up:[к оглавлению](README.md#Оглавление)


### Этапы работы над проектом  
Работа над проектом проходила в семь этапов.

На первом этапе происходила загрузка предварительная очистка данных от дубликатов.

На втором этапе были проведены отбор и генерация признаков. Из многообразных вариантов записей в столбцах, особенно с категориальными признакми, были выбраны наиболее типичные. Записи были унифицированы и приведены к необходимому формату. Из столбцов 'homeFacts' и 'schools' были извлечены новые информативные признаки. Кроме того, из данных о географическом положении дома были сгенерированы новые признаки: о медианной стоимости домов в данном районе, уровне экономического развития и общего качества жизни в данном районе.

Третий этап - разведывательный анализ данных и заполнение пропусков. На данном этапе были заполнены пропуски на основе зависимостей в данных, чтобы потеря информации была минимальной. Также признаки были очищены от выбросов по методу Тьюки.

На четвёртом этапе был произведён подбор оптимальной модели машинного обучения. Были опробованы как линейные, так и ансамблевые модели. На основе метрики качества MAPE была выбрана саммая эффективная модель. Ей оказался стекинг из случайного леса, деревьев решений, экстремального градиентного бустинга и catboost. В качестве метамодели была выбрана линейная регрессия.

На пятом финальном этапе осуществлялся подбор гиперпараметров моделей, в результате чего метрика качества улучшилась на 0.15 и достигла показателя 0.1448, что эквивалентно 47049.47 дол. в абсолютном выражении.

На шестом этапе для проверки работоспособности модели был осуществлён прогноз на основании данных, взятых из исходного набора данных. Ошибка составила 30 тыс. дол., что является неплохим показателем предсказательной силы модели.

Седьмой заключительный этап - деплой модели. Был составлен пайплайн, произведена сериализация модели, данные были подготовлены для деплоя.
:arrow_up:[к оглавлению](README.md#Оглавление)


### Результаты:  
В результате проделанной работы была создана модель машинного обучения, которая предсказывает стоимость дома для риелторского агенства. Метрика MAPE на финальной модели составляет 0.1448, что составляет погрешность в 47049.47 дол. Модель была сериализована и подготовлена к деплою.
:arrow_up:[к оглавлению](README.md#Оглавление)


### Выводы:  
Получена модель, которая эффективно предсказывает цену на недвижимость в США. Цель проекта достигнута.

:arrow_up:[к оглавлению](README.md#Оглавление)


Если информация по этому проекту покажется вам интересной или полезной, то я буду очень вам благодарен, если отметите репозиторий и профиль ⭐️⭐️⭐️-дами
