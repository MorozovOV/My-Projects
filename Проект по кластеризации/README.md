# Проект 6. Пострение модели машинного обучения. Кластеризация.

## Оглавление  
[1. Описание проекта](README.md#Описание-проекта)  
[2. Какой кейс решаем?](README.md#Какой-кейс-решаем)  
[3. Краткая информация о данных](README.md#Краткая-информация-о-данных)  
[4. Этапы работы над проектом](README.md#Этапы-работы-над-проектом)  
[5. Результат](README.md#Результат)    
[6. Выводы](README.md#Выводы) 

### Описание проекта    
Нам предоставили набор данных, содержащий транзакции компании, занимающейся розничной онлайн-торговлей. Компания в основном продаёт уникальные подарки на все случаи жизни. Многие клиенты являются оптовиками. Чтобы быстро и точно реагировать на перемены в поведении клиентов и создавать инструменты, которые обнаруживают эти изменения практически в режиме реального времени, компания обратилась к нам с целью построения модели машинного обучения, которая поможет определить категорию клиентов (например, лояльные/перспективные/новички/«спящие»/ушедшие) и выбирать правильную стратегию взаимодействия с ними.

[к оглавлению](README.md#Оглавление)

### Какой кейс решаем?    
**Бизнес-задача**: произвести сегментацию существующих клиентов, проинтерпретировать эти сегменты и определить стратегию взаимодействия с ними.

**Техническая задача для специалиста в Data Science**: построить модель кластеризации клиентов на основе их покупательской способности, частоты заказов и срока давности последней покупки, определить профиль каждого из кластеров.

**Метрика качества**     
Результат работы алгоритма снижения размерности оценивался показателем дивергенции Кульбака—Лейблера.
Для оценки качества кластеризации использовался коэффициент силуэта.
Оценка качества классификации производилась при помощи метрики accuracy.

**Использованные библиотеки Python**
pandas
numpy
matplotlib
seaborn
plotly.express
sklearn

### Краткая информация о данных
В использованном нами [набре данных](https://drive.google.com/file/d/1Axlknf1Rd6T6UFRzWWZA_gBbfN2g9r3v/view) содержится следующая информация:
* InvoiceNo — номер счёта-фактуры (уникальный номинальный шестизначный номер, присваиваемый каждой транзакции; буква "C" в начале кода указывает на отмену транзакции);
* Stock Code — код товара (уникальное пятизначное целое число, присваиваемое каждому отдельному товару);
* Description — название товара;
* Quantity — количество каждого товара за транзакцию;
* InvoiceDate — дата и время выставления счёта/проведения транзакции;
* UnitPrice — цена за единицу товара в фунтах стерлингов;
* CustomerID — идентификатор клиента (уникальный пятизначный номер, однозначно присваиваемый каждому клиенту);
* Country — название страны, в которой проживает клиент.

[к оглавлению](README.md#Оглавление)

### Этапы работы над проектом  
Работа над проектом проходила в пять этапов.

На первом этапе происходила загрузка данных и первичное ознакомление с датасетом.

На втором этапе была проведена предобработка и очистка данных.

Третий этап - разведывательный анализ данных. Задачи, которые решались на данном этапе:
* понять, клиенты из каких стран покупают больше и чаще;
* узнать, присутствует ли в продажах сезонность (когда покупают чаще);
* создать новые признаки, которые в дальнейшем понадобятся при формировании датасета о клиентах.

На четвёртом этапе была произведена RFM-сегментация клиентов меодами кластеризации с предварительным снижением размерности. Для снижения размерности использовались пайплайны с алгоритмами стандартизации данных и снижения размерности (PCA и t-SNE). Для кластеризации данных использовались методы k-means и EM-алгоритм.

На пятом финальном этапе была построена модель на основе классификации для предсказания принадлежности к тому или иному сегменту для новых клиентов. В качестве целевой переменной для алгоритмов классификации были использованы RFM-характеристики, полученные в ходе кластеризации на предыдущем этапе. Использовались ансамблевые модели на основе случайного леса и градиентного бустинга. Подбор гиперпараметров производился при помощи метода GridSearchCV.

[к оглавлению](README.md#Оглавление)

### Результаты:  
В результате проделанной работы было установлено, что в качестве метода снижения размерности для поставленных задач лучше всего алгоритм t-SNE, а также алгоритм кластеризации k-means. Для финальной предсказательной модели лучше всего подошёл случайный лес. Метрика accuracy на финальной модели показала результат 0.985.

[к оглавлению](README.md#Оглавление)

### Выводы:  
Получена модель, которая на основе RFM-характерик клиента автоматически определяет его сегмент. Цель проекта достигнута.

[к оглавлению](README.md#Оглавление)


Если информация по этому проекту покажется вам интересной или полезной, то я буду очень вам благодарен, если отметите репозиторий и профиль ⭐️⭐️⭐️-дами
